function imageLightbox(t,e){var n=0,o=0,i=0,a=$(),r=[],l=!1;options={},targetID=0;var d=this,s=function(){var t=document.body||document.documentElement,t=t.style;return""==t.WebkitTransition?"-webkit-":""==t.MozTransition?"-moz-":""==t.OTransition?"-o-":""==t.transition?"":!1},u=s()===!1?!1:!0,f=function(t,e,n){var o={},i=s();o[i+"transform"]="translateX("+e+")",o[i+"transition"]=i+"transform "+n+"s linear",t.css(o)},c="ontouchstart"in window,g=window.navigator.pointerEnabled||window.navigator.msPointerEnabled,p=function(t){if(c)return!0;if(!g||"undefined"==typeof t||"undefined"==typeof t.pointerType)return!1;if("undefined"!=typeof t.MSPOINTER_TYPE_MOUSE){if(t.MSPOINTER_TYPE_MOUSE!=t.pointerType)return!0}else if("mouse"!=t.pointerType)return!0;return!1};this.setOptions=function(t){options=$.extend({selector:'id="imagelightbox"',allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,preloadNext:!0,enableKeyboard:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,onStart:!1,onEnd:!1,onLoadStart:!1,onLoadEnd:!1,fillMode:2},t)},this.updateoptions=function(t){options=$.extend(options,t)},this.setGallery=function(t){r=t},"undefined"!=typeof e?(this.setOptions(e),this.setGallery(t)):"undefined"!=typeof t&&this.setOptions(t),this.setImage=function(){if(!a.length)return!0;var t=$(window).width(),e=$(window).height(),i=new Image;i.onload=function(){if(n=i.width,o=i.height,0==options.fillMode&&(t*=.9,e*=.95),n>t||o>e){var r;r=2==options.fillMode?n/o>t/e?o/e:n/t:n/o>t/e?n/t:o/e,n/=r,o/=r}a.css({width:n+"px",height:o+"px",top:($(window).height()-o)/2+"px",left:($(window).width()-n)/2+"px"})},i.src=a.attr("src")},this.loadImage=function(t){if(l)return!1;if(t="undefined"==typeof t?!1:"left"==t?1:-1,a.length){if(t!==!1&&(r.length<2||options.quitOnEnd===!0&&(1===t&&0==targetID||-1===t&&targetID==r.length-1)))return d.self.quitLightbox(),!1;var e={opacity:0};u?f(a,100*t-i+"px",options.animationSpeed/1e3):e.left=parseInt(a.css("left"))+100*t+"px",a.animate(e,options.animationSpeed,function(){d.removeImage()}),i=0}l=!0,options.onLoadStart!==!1&&options.onLoadStart(),setTimeout(function(){a=$("<img "+options.selector+">").load(function(){a.appendTo("body"),d.setImage();var e={opacity:1};if(a.css("opacity",0),u)f(a,-100*t+"px",0),setTimeout(function(){f(a,"0px",options.animationSpeed/1e3)},50);else{var n=parseInt(a.css("left"));e.left=n+"px",a.css("left",n-100*t+"px")}if(a.animate(e,options.animationSpeed,function(){l=!1,options.onLoadEnd!==!1&&options.onLoadEnd()}),options.preloadNext){var o=targetID+1;0>o?o=r.length-1:o>=r.length&&(o=0),$("<img>").attr("src",r[o]).load()}}).error(function(){options.onLoadEnd!==!1&&options.onLoadEnd()}).attr("src",r[targetID]);var e=0,o=0,s=0;a.on(g?"pointerup MSPointerUp":"click",function(t){if(t.preventDefault(),options.quitOnImgClick)return d.self.quitLightbox(),!1;if(p(t.originalEvent))return!0;var e=(t.pageX||t.originalEvent.pageX)-t.target.offsetLeft;targetID+=n/2>e?-1:1,targetID<0?targetID=r.length-1:targetID>=r.length&&(targetID=0),d.loadImage(n/2>e?"left":"right")}).on("touchstart pointerdown MSPointerDown",function(t){return!p(t.originalEvent)||options.quitOnImgClick?!0:(u&&(s=parseInt(a.css("left"))),void(e=t.originalEvent.pageX||t.originalEvent.touches[0].pageX))}).on("touchmove pointermove MSPointerMove",function(t){return!p(t.originalEvent)||options.quitOnImgClick?!0:(t.preventDefault(),o=t.originalEvent.pageX||t.originalEvent.touches[0].pageX,i=e-o,void(u?f(a,-i+"px",0):a.css("left",s-i+"px")))}).on("touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",function(t){return!p(t.originalEvent)||options.quitOnImgClick?!0:void(Math.abs(i)>50?(targetID+=0>i?-1:1,targetID<0?targetID=r.length-1:targetID>=r.length&&(targetID=0),d.loadImage(i>0?"right":"left")):u?f(a,"0px",options.animationSpeed/1e3):a.animate({left:s+"px"},options.animationSpeed/2))})},options.animationSpeed+100)},this.removeImage=function(){return a.length?(a.remove(),void(a=$())):!1},this.quitLightbox=function(){return a.length?void a.animate({opacity:0},options.animationSpeed,function(){d.removeImage(),l=!1,options.onEnd!==!1&&options.onEnd()}):!1},this.addTrigger=function(t){return t.click(function(t){t.preventDefault(),options.onStart!==!1&&options.onStart(),targetID=Number($(this).data("id")),d.loadImage()})},$(function(){$(window).on("resize",d.setImage),options.quitOnDocClick&&$(document).on(c?"touchend":"click",function(t){a.length&&!$(t.target).is(a)&&d.quitLightbox()}),options.enableKeyboard&&$(document).on("keyup",function(t){return a.length?(t.preventDefault(),27==t.keyCode&&d.quitLightbox(),void((37==t.keyCode||39==t.keyCode)&&(targetID+=37==t.keyCode?-1:1,targetID<0?targetID=r.length-1:targetID>=r.length&&(targetID=0),d.loadImage(37==t.keyCode?"left":"right")))):!0})})}function TileAnimation(t,e,n,o,i){var a,r,l,d,s,u=0,f=0,c=!1,g=new imageLightbox({onStart:function(){ilbFunc.overlay.on(),ilbFunc.closeButton.on(),p.stop()},onEnd:function(){ilbFunc.overlay.off(),ilbFunc.closeButton.off(),ilbFunc.loader.off(),p.rotate()},onLoadStart:function(){ilbFunc.loader.on()},onLoadEnd:function(){ilbFunc.loader.off()},fillMode:"undefined"==typeof i?2:i}),p=this;this.rotMany=1,this.rotDuration=650,this.rotDelay=250,this.probability=.85,this.ini=function(t,e,n,o){if(u=e.length,f=o,f>=u)return!1;for(var i=new Array(u),d=0;u>d;d++)i[d]=e[d][1];g.setGallery(i),r=e,a=new Array(u),s=new Array(u),l=$(t).html("").addClass("square-gallery");for(var d=0;f>d;d++)a[d]={rotating:!1,tile:$('<div class="tile"></div>'),a:g.addTrigger($('<a class="zoom" href="'+e[n+d][1]+'" target="_blank">').data("id",d)),img:$('<img src="'+e[n+d][0]+'">')},s[d]=n+d,l.append(a[d].tile.append(a[d].img).append(a[d].a));p.rotate()},this.rotate=function(){c=!0;for(var t=new Array(p.rotMany),e=0,n=0;n<t.length;n++){do e=Math.floor(Math.random()*f);while(-1!==t.indexOf(e));t[n]=e,Math.random()<=p.probability&&p.rotateTile(e)}clearTimeout(d),d=setTimeout(function(){p.rotate()},p.rotDelay)},this.rotateTile=function(t){if(a[t].rotating===!0)return!1;a[t].rotating=!0;var e=0;do e=Math.floor(Math.random()*u);while(-1!==s.indexOf(e));s[t]=e;var n=$('<img src="'+r[e][0]+'">');a[t].tile.append(n),a[t].img.addClass("slide"),a[t].a.attr("href",r[e][1]).data("id",e),setTimeout(function(){a[t].rotating=!1,a[t].img.remove(),a[t].img=n},p.rotDuration)},this.stop=function(){clearTimeout(d),c=!1},this.toggle=function(){c?p.stop():p.rotate()},"undefined"!=typeof t&&"undefined"!=typeof e&&("undefined"==typeof n&&(n=0),"undefined"==typeof o&&(o=e.length),$(function(){p.ini(t,e,n,o)}))}var ilbFunc={overlay:{created:!1,create:function(){return this.created?!1:(this.created=!0,void $("body").append('<div id="imagelightbox-overlay"></div>'))},on:function(){$("#imagelightbox-overlay").addClass("visible")},off:function(){$("#imagelightbox-overlay").removeClass("visible")}},loader:{created:!1,create:function(){return this.created?!1:(this.created=!0,void $("body").append('<div id="imagelightbox-loading"></div>'))},on:function(){$("#imagelightbox-loading").addClass("visible")},off:function(){$("#imagelightbox-loading").removeClass("visible")}},closeButton:{created:!1,create:function(){return this.created?!1:(this.created=!0,void $("body").append('<div id="imagelightbox-x">&times;</div>'))},on:function(){$("#imagelightbox-x").addClass("visible")},off:function(){$("#imagelightbox-x").removeClass("visible")}},createDefault:function(){$(function(){ilbFunc.overlay.create(),ilbFunc.loader.create(),ilbFunc.closeButton.create()})}};ilbFunc.createDefault();
